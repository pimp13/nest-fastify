model Issue {
    id          String   @id @default(uuid())
    projectId   String
    typeId      String
    sprintId    String?
    parentId    String?
    reporterId  String
    assigneeId  String?
    statusId    String
    title       String
    description String?
    priority    String // LOW, MEDIUM, HIGH, CRITICAL
    storyPoint  Int?
    createdAt   DateTime @default(now())
    updatedAt   DateTime @updatedAt

    project  Project   @relation(fields: [projectId], references: [id])
    type     IssueType @relation(fields: [typeId], references: [id])
    sprint   Sprint?   @relation(fields: [sprintId], references: [id])
    reporter User      @relation("IssueReporter", fields: [reporterId], references: [id])
    assignee User?     @relation("IssueAssignee", fields: [assigneeId], references: [id])
    status   Status    @relation(fields: [statusId], references: [id])
    parent   Issue?    @relation("ParentIssue", fields: [parentId], references: [id])
    children Issue[]   @relation("ParentIssue")

    comments    IssueComment[]
    attachments IssueAttachment[]

    linkedFrom IssueLink[] @relation("fromIssue")
    linkedTo   IssueLink[] @relation("toIssue")

    @@index([projectId])
    @@index([reporterId])
    @@index([assigneeId])
    @@index([priority])
    @@index([statusId])
}

model IssueType {
    id          String  @id @default(uuid())
    name        String
    description String?

    issues Issue[]
}

model Sprint {
    id        String    @id @default(uuid())
    name      String
    projectId String
    startDate DateTime?
    endDate   DateTime?
    isActive  Boolean   @default(false)

    project Project @relation(fields: [projectId], references: [id])
    issues  Issue[]
}

model IssueLink {
    id     String @id @default(uuid())
    fromId String
    toId   String
    type   String // BLOCKER, DUPLICATE, RELATES_TO â€¦

    from Issue @relation("fromIssue", fields: [fromId], references: [id])
    to   Issue @relation("toIssue", fields: [toId], references: [id])
}

model IssueAttachment {
    id        String   @id @default(uuid())
    issueId   String
    fileUrl   String
    fileName  String
    createdAt DateTime @default(now())

    issue Issue @relation(fields: [issueId], references: [id])
}

model IssueComment {
    id        String   @id @default(uuid())
    issueId   String
    userId    String
    content   String
    createdAt DateTime @default(now())

    issue Issue @relation(fields: [issueId], references: [id])
    user  User  @relation(fields: [userId], references: [id])
}

// enum IssueType {
//     BUG
//     TASK
//     STORY
//     EPIC
//     SUBTASK
// }

// enum IssueStatus {
//     TO_DO
//     IN_PROGRESS
//     IN_REVIEW
//     DONE
// }

// enum IssuePriority {
//     LOW
//     MEDIUM
//     HIGH
//     CRITICAL
// }
